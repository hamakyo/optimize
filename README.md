# Windows最適化スクリプト

## 概要
Windowsのパフォーマンスを向上させるための最適化を自動実行します。

## ❗️ 重要な注意事項

### セキュリティについて
- **ExecutionPolicy Bypassを使用**: システムのセキュリティポリシーを一時的に迷回します
- **管理者権限が必要**: システムレジストリや電源設定の変更のため
- **企業環境での利用**: 組織のセキュリティポリシーによっては実行できない場合があります

### 変更範囲について
- **ユーザー単位の設定**: 固定キー、ゲームモード、視覚効果、OneDrive設定、Downloadsフォルダ
- **システム全体の設定**: 高速スタートアップ、電源プラン
- **影響範囲**: 現在ログイン中のユーザーとシステム全体

### リスクと対応
- **Dドライブ依存**: Dドライブがない環境では標準Downloadsフォルダを使用
- **元に戻す方法**: `restore.ps1` で全設定を元の状態に戻せます

## 実行手順

### 最適化の実行
1. `run_as_admin.bat` をダブルクリック
2. UACの確認が出たら「はい」をクリック
3. 自動で最適化が完了

### 設定を元に戻す
1. `run_restore_admin.bat` をダブルクリック
2. UACの確認が出たら「はい」をクリック
3. 自動で復元が完了

## 最適化内容

1. **固定キー無効化** (ユーザー単位)
   - Shiftキー5回連打で出るダイアログを無効化

2. **電源プラン変更** (システム全体)
   - パフォーマンス重視の「高パフォーマンス」に変更

3. **高速スタートアップ無効化** (システム全体)
   - シャットダウン時のハイブリッド休止状態を無効化
   - トラブルの原因となることがあるため

4. **ゲームモード有効化** (ユーザー単位)
   - ゲーム中のパフォーマンス最適化を促進

5. **視覚効果無効化** (ユーザー単位)
   - ウィンドウアニメーションと透過効果を無効化してパフォーマンス向上

6. **OneDrive自動起動停止** (ユーザー単位)
   - サインイン時のOneDrive自動起動を無効化

7. **Downloadsフォルダ変更** (ユーザー単位)
   - Dドライブがある場合はD:\Downloadsに変更
   - Dドライブがない場合は標準フォルダを維持

## ファイル構成

- `optimize.ps1` - メインの最適化スクリプト
- `run_as_admin.bat` - 最適化スクリプトを管理者権限で実行
- `restore.ps1` - 変更を元に戻すスクリプト
- `run_restore_admin.bat` - 復元スクリプトを管理者権限で実行

## 使用上の注意

- **自己責任で使用してください**
- **実行前にシステムのバックアップを推奨します**
- **企業環境では管理者に確認してから使用してください**
- **システムが不安定になった場合は、restore.ps1で設定を戻してください**